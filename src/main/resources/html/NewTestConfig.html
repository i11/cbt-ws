<html>

<head>
<title>New Test Config</title>
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="/jqueryui/ui/jquery-ui.js"></script>
<script src="/js/cbtclient.js"></script>
<script src="/js/common.js"></script>
<script src="/js/md5.js"></script>
</head>

<body onload="onLoad();">

	<script type="text/javascript">
		function onLoadPageSpecific() {
			// Get test profiles
			$.ajax({
				type : 'GET',
				url : rootURL + '/testprofile',
				dataType : "json",
				success : function(json) {					
					$.each(json, function(i, data) {
						console.log(data);
						$("#testProfileId").append('<option value="' + data.id + '">' + data.name +'</option>');
					})
				}
			});
			// Get test scripts
			$.ajax({
				type : 'GET',
				url : rootURL + '/testscript',
				dataType : "json",
				success : function(json) {					
					$.each(json, function(i, data) {
						console.log(data);
						$("#testScriptId").append('<option value="' + data.id + '">' + data.name +'</option>');
					})
				}
			});
			// Get Test targets
			$.ajax({
				type : 'GET',
				url : rootURL + '/testtarget',
				dataType : "json",
				success : function(json) {					
					$.each(json, function(i, data) {
						console.log(data);
						$("#testTargetId").append('<option value="' + data.id + '">' + data.name +'</option>');
					})
				}
			});
			
			$("button").button().click(function(event) {
				console.log("....");
				$.ajax({
			        type: 'PUT',
			        contentType: 'application/json',
			        url: rootURL + '/testconfig',
			        dataType: "json",
			        data: formToJSON(),
			        success: function(data, textStatus, jqXHR){
			            alert('Test config added');
			        },
			        error: function(jqXHR, textStatus, errorThrown){
			            alert('Error: ' + textStatus);
			        }
			    });

			});	
		}		
		
		function formToJSON() {
		    return JSON.stringify({
		        "testProfileId": $('#testProfileId').val(),
		        "testScriptId": $('#testScriptId').val(),
		        "testTargetId": $('#testTargetId').val(),
		        "name": $('#name').val()
		        });
		}
	</script>
	<div id="header"></div>
	<div id="contents">
			Name:
			<input type="text" name="name" id="name"><br />
			
			Test profile:
			<select id="testProfileId">				
			</select><br />
			
			Test script:
			<select id="testScriptId">				
			</select><br />
			
			Test Target:
			<select id="testTargetId">				
			</select>
			<br />		
			<button id="submit">SUBMIT</button>
	</div>

</body>
</html>